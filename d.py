driver1.get("https://payeer.com/en/auth/?register=yes")

        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'email'))).send_keys(f"chahmadhassanjee+{generate_random_string()}@gmail.com")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '//*[@id="login-step1"]/div/div[2]/form/button[2]'))).click()
        
        time.sleep(5)

        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '/html/body/div[2]/main/div[2]/div/div[2]/form/button[3]'))).click()
        
        time.sleep(2)

        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'new_password'))).clear()
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'new_password2'))).clear()
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'secret_word'))).clear()
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'new_password'))).send_keys("ahmaD4764346@")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'new_password2'))).send_keys("ahmaD4764346@")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'secret_word'))).send_keys("3530101")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '/html/body/div[2]/main/div/div[2]/form/button[2]'))).click()
        
        time.sleep(2)

        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'name'))).send_keys("ahmad")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.NAME, 'last_name'))).send_keys("hassan")
        
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '/html/body/div[2]/main/div/div[2]/form/div[7]/div/div[1]/div[1]'))).click()
        
        time.sleep(1)
        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '/html/body/div[2]/main/div/div[2]/form/div[7]/div/div[2]/ul/li[3]'))).click()


        time.sleep(1)

        WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '/html/body/div[2]/main/div/div[2]/form/button[2]'))).click()
        

        time.sleep(5)



        payeer_account = WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '//*[@id="pjax-container"]/div/div[1]/div/div[2]/div/div[1]/div[2]'))).text
        print(payeer_account)
        
        key = WebDriverWait(driver1, 10).until(
                    EC.presence_of_element_located((By.XPATH, '//*[@id="pjax-container"]/div/div[1]/div/div[2]/div/div[4]/div[2]'))).text
        
        print(key)
        
        with open("accounts.txt" ,'a') as e:
            e.write(f"payeer_account: {payeer_account}\nKey: {key}\n")